<!doctype html>
<meta charset="utf-8">
<title>UFO Space</title>

<body>
    <style>
        * {
            padding: 0;
            margin: 0;
            overflow: hidden
        }
    </style>
    <script src="pixi.min.js"></script>

    <audio autoplay loop>
  <source src="https://github.com/parente/spaceship/blob/master/sounds/mp3/music/131207_Orion_sBelt_1st.mp3?raw=true" type="audio/mpeg"> 
    
    </audio>
    <script>
        //PIXI Link
        let Application = PIXI.Application,
            Container = PIXI.Container,
            loader = PIXI.loader,
            resources = PIXI.loader.resources,
            Graphics = PIXI.Graphics,
            TextureCache = PIXI.utils.TextureCache,
            Sprite = PIXI.Sprite,
            Text = PIXI.Text,
            TextStyle = PIXI.TextStyle;

        //Create a Pixi Application
        let app = new Application({
            width: window.innerWidth,
            height: window.innerHeight,
            antialiasing: true,
            transparent: false,
            resolution: 1
        });


        //Add the canvas that Pixi automatically created for you to the HTML document
        document.body.appendChild(app.view);

        loader
            .add("UFO.png")
            .add("background.jpg")
            .add("meteor.png")
            .add("Alien.png")
            .add("Portal.png")
            .add("meteor2.png")
            .add("end.png")
            .add("win.png")
            .add("coin.png")
            .load(setup);

        //Define variables that might be used in more 
        //than one function
        let state, UFO, Alien, Meteors, chimes, exit, player, dungeon, currentLevel = 0,
            Portal, healthBar, message, gameScene, coin23, coin24, coin25, coin26, gameOverScene, coin, coin1, coin2, coin3, coin4, coin5, coin6, coin7, coin8, coin9, coin10, coin11, coin12, enemies, won, coin13, coin14, coin15, coin16, coin17, coin18, coin19, coin20, coin21, coin22, id, Portal2, fuel = 128,
            FuelBar, fuelRate = 0.05,
            level2, Portal1, level1;

        //Capture the keyboard arrow keys
        let left = keyboard(37),
            up = keyboard(38),
            right = keyboard(39),
            down = keyboard(40);

        function setup() {


            //Make the game scene and add it to the stage
            gameScene = new Container();
            app.stage.addChild(gameScene);




            background = new Sprite(resources["background.jpg"].texture);
            gameScene.addChild(background);

            var graphics = new PIXI.Graphics();
            graphics.lineStyle(2, 0x0000FF, 1);
            graphics.drawRect(0, 0, 160, window.innerHeight);
            app.stage.addChild(graphics)


            //Portal
            Portal = new Sprite(resources["Portal.png"].texture);
            Portal.position.set(910, 50);
            gameScene.addChild(Portal);
            Portal.scale.set(0.3);

            let basicStyle = new PIXI.TextStyle({
                fill: "white"
            });
            const basicText = new PIXI.Text('Collect Your Alien Friends without being Killed by the Meteors and Go through the Correct Escape Portal to Go Home', basicStyle);

            basicText.x = 320;
            basicText.y = 10;


            app.stage.addChild(basicText);

            Portal1 = new Sprite(resources["Portal.png"].texture);
            Portal1.position.set(910, 720);
            gameScene.addChild(Portal1);
            Portal1.scale.set(0.3);



            const basicText1 = new PIXI.Text('Controls:', basicStyle);
            app.stage.addChild(basicText1);
            basicText1.x = 20;
            basicText1.y = 700;

            const basicText2 = new PIXI.Text('Arrows:', basicStyle);
            app.stage.addChild(basicText2);
            basicText2.x = 20;
            basicText2.y = 750;

            const basicText3 = new PIXI.Text('Left, Right,', basicStyle);
            app.stage.addChild(basicText3);
            basicText3.x = 20;
            basicText3.y = 800;

            const basicText4 = new PIXI.Text('Up, Down', basicStyle);
            app.stage.addChild(basicText4);
            basicText4.x = 20;
            basicText4.y = 850;

            const basicText5 = new PIXI.Text('Health:', basicStyle);
            app.stage.addChild(basicText5);
            basicText5.x = 40;
            basicText5.y = 0;


            const basicText6 = new PIXI.Text('Fuel:', basicStyle);
            app.stage.addChild(basicText6);
            basicText6.x = 205;
            basicText6.y = 0;




            //Explorer

            UFO = new Sprite(resources["UFO.png"].texture);
            UFO.x = 15;
            UFO.y = 50 //gameScene.height / 2 - UFO.height / 2;
            UFO.vx = 0;
            UFO.vy = 0;
            app.stage.addChild(UFO);
            UFO.scale.set(0.038);



            //Alien
            Alien = new Sprite(resources["Alien.png"].texture);
            Alien.x = 930;
            Alien.y = 400;
            gameScene.addChild(Alien);
            Alien.scale.set(0.3);

            Alien1 = new Sprite(resources["Alien.png"].texture);
            Alien1.x = 1600;
            Alien1.y = 600;
            gameScene.addChild(Alien1);
            Alien1.scale.set(0.3);

            Alien2 = new Sprite(resources["Alien.png"].texture);
            Alien2.x = 1300;
            Alien2.y = 150;
            gameScene.addChild(Alien2);
            Alien2.scale.set(0.3);

            Alien3 = new Sprite(resources["Alien.png"].texture);
            Alien3.x = 300;
            Alien3.y = 600;
            gameScene.addChild(Alien3);
            Alien3.scale.set(0.3);

            Alien4 = new Sprite(resources["Alien.png"].texture);
            Alien4.x = 610;
            Alien4.y = 150;
            gameScene.addChild(Alien4);
            Alien4.scale.set(0.3);


            //Make the Meteors
            let numberOfMeteors = 12,
                spacing = 200,
                xOffset = 200,
                speed = 5,
                ydirection = 1;
            xdirection = 1;



            //An array to store all the meteor 
            Meteors = [];

            //Make as many Meteors as there are `numberOfMeteors
            for (let i = 0; i < numberOfMeteors; i++) {

                //Make a meteor

                //let meteor = new Sprite(id["meteor.png"]);
                let meteor;
                meteorNumb = Math.floor(Math.random() * 3);
                switch (meteorNumb) {
                    case 0:
                        meteor = new Sprite(resources["meteor2.png"].texture);
                        meteor.scale.set(0.5);
                        break;
                    case 1:
                        meteor = new Sprite(resources["meteor2.png"].texture);
                        meteor.scale.set(0.2);
                        break;
                    case 2:
                        meteor = new Sprite(resources["meteor2.png"].texture);
                        meteor.scale.set(0.3);
                        break;
                    default:
                        meteor = new Sprite(resources["meteor2.png"].texture);
                        break;
                }


                //Space each meteor horizontally according to the `spacing` value.
                //`xOffset` determines the point from the left of the screen
                //at which the first meteor should be added
                let x = spacing * i + xOffset;

                //Give the meteor a random y position
                let y = randomInt(0, app.stage.height - meteor.height);

                //Set the meteor's position
                meteor.x = x;
                meteor.y = y;

                //Set the meteor's vertical velocity. `direction` will be either `1` or
                //`-1`. `1` means the enemy will move down and `-1` means the meteor will
                //move up. Multiplying `direction` by `speed` determines the meteor's
                //vertical direction
                meteor.vx = speed * xdirection * (Math.random() + 0.5);
                meteor.vy = speed * ydirection * (Math.random() + 0.5);

                //Reverse the direction for the next meteor
                xdirection *= -1;
                ydirection *= -1;

                //Push the meteor into the `Meteors` array
                Meteors.push(meteor);

                //Add the meteor to the `gameScene`
                gameScene.addChild(meteor);
            }

            //Create the health bar
            healthBar = new Container();
            healthBar.position.set(15, 30)
            gameScene.addChild(healthBar);


            healthBar.foo = 3456789
                //Create the black background rectangle
            let innerBar = new Graphics();
            innerBar.beginFill(0x000000);
            innerBar.drawRect(0, 0, 128, 8);
            innerBar.endFill();
            healthBar.addChild(innerBar);

            //Create the front red rectangle
            let outerBar = new Graphics();
            outerBar.beginFill(0xFF3300);
            outerBar.drawRect(0, 0, 128, 8);
            outerBar.endFill();
            healthBar.addChild(outerBar);

            healthBar.outer = outerBar;


            //Create the fuel bar
            FuelBar = new Container();
            FuelBar.position.set(170, 30)
            gameScene.addChild(FuelBar);
            FuelBar.foo = 3456789
                //Create the black background rectangle
            let innerBar1 = new Graphics();
            innerBar1.beginFill(0x000000);
            innerBar1.drawRect(0, 0, 128, 8);
            innerBar1.endFill();
            FuelBar.addChild(innerBar1);

            //Create the front red rectangle
            let outerBar1 = new Graphics();
            outerBar1.beginFill(0xFF3300);
            outerBar1.drawRect(0, 0, 128, 8);
            outerBar1.endFill();
            FuelBar.addChild(outerBar1);

            FuelBar.outer = outerBar1;

            //Create the `gameOver` scene
            gameOverScene = new Container();
            app.stage.addChild(gameOverScene);

            //Make the `gameOver` scene invisible when the game first starts
            gameOverScene.visible = false;

            //Create the text sprite and add it to the `gameOver` scene
            let style = new TextStyle({
                fontFamily: "Futura",
                fontSize: 80,
                fill: "white"
            });
            //message = new Text("The End!", style);
            //message.x = 550;
            //message.y = 300;
            //gameOverScene.addChild(message);

            //Set the game state
            state = play;

            //Start the game loop 
            app.ticker.add(delta => gameLoop(delta));
        }


        function gameLoop(delta) {

            //Update the current game state:
            state(delta);
        }


        function play(delta) {

            UFO.vx = 0;
            UFO.vy = 0;
            if (fuel > 0) {
                if (left.isDown && !right.isDown) {
                    UFO.vx = -5;
                }
                if (right.isDown && !left.isDown) {
                    UFO.vx = 5;
                }
                if (up.isDown && !down.isDown) {
                    UFO.vy = -5;
                }
                if (down.isDown && !up.isDown) {
                    UFO.vy = 5;
                }
            }

            FuelBar.outer.width = fuel;

            if ((up.isDown || right.isDown || down.isDown || left.isDown) && fuel > 0) {
                fuel -= fuelRate;
            }

            //use the explorer's velocity to make it move
            UFO.x += UFO.vx;
            UFO.y += UFO.vy;

            //Contain the explorer inside the area of the dungeon
            contain(UFO, {
                x: 28,
                y: 10,
                width: window.innerWidth,
                height: window.innerHeight
            });
            //contain(explorer, stage);

            //Set `explorerHit` to `false` before checking for a collision
            let UFOHit = false;

            //Loop through all the sprites in the `enemies` array
            Meteors.forEach(function(meteor) {

                //Move the meteor
                meteor.x += meteor.vx;
                meteor.y += meteor.vy;

                //Check the meteor's screen boundaries
                let meteorHitsWall = contain(meteor, {
                    x: 160,
                    y: 0,
                    width: window.innerWidth,
                    height: window.innerHeight
                });

                //If the meteor hits the top or bottom of the stage, reverse
                //its direction
                if (meteorHitsWall === "top" || meteorHitsWall === "bottom") {
                    meteor.vy *= -1;
                }
                if (meteorHitsWall === "left" || meteorHitsWall === "right") {
                    meteor.vx *= -1;
                }

                //Test for a collision. If any of the enemies are touching
                //the explorer, set `explorerHit` to `true`
                if (hitTestRectangle(UFO, meteor)) {
                    UFOHit = true;
                }
            });

            //If the explorer is hit...
            if (UFOHit) {

                //Make the explorer semi-transparent
                UFO.alpha = 0.5;

                //Reduce the width of the health bar's inner rectangle by 1 pixel
                healthBar.outer.width -= 1.0;

            } else {

                //Make the explorer fully opaque (non-transparent) if it hasn't been hit
                UFO.alpha = 1;
            }

            //Check for a collision between the explorer and the Alien
            if (hitTestRectangle(UFO, Alien)) {

                //If the Alien is touching the explorer, center it over the explorer
                Alien.x = UFO.x + 30;
                Alien.y = UFO.y + 10;

            }

            //Check for a collision between the explorer and the Alien
            if (hitTestRectangle(UFO, Alien1)) {

                //If the Alien is touching the explorer, center it over the explorer
                Alien1.x = UFO.x + 30;
                Alien1.y = UFO.y + 10;

            }

            //Check for a collision between the explorer and the Alien
            if (hitTestRectangle(UFO, Alien2)) {

                //If the Alien is touching the explorer, center it over the explorer
                Alien2.x = UFO.x + 30;
                Alien2.y = UFO.y + 10;

            }

            //Check for a collision between the explorer and the Alien
            if (hitTestRectangle(UFO, Alien3)) {

                //If the Alien is touching the explorer, center it over the explorer
                Alien3.x = UFO.x + 30;
                Alien3.y = UFO.y + 10;

            }

            //Check for a collision between the explorer and the Alien
            if (hitTestRectangle(UFO, Alien4)) {

                //If the Alien is touching the explorer, center it over the explorer
                Alien4.x = UFO.x + 30;
                Alien4.y = UFO.y + 10;

            }










































            if (currentLevel === 0 && hitTestRectangle(Alien, Portal1) && hitTestRectangle(Alien1, Portal1) && hitTestRectangle(Alien2, Portal1) && hitTestRectangle(Alien3, Portal1) && hitTestRectangle(Alien4, Portal1)) {
                currentLevel = 1;
                state = end;
                setTimeout(function() {
                    location.reload()
                }, 10);
            }



            //If the explorer has brought the Alien to the exit,
            //end the game and display "You won!"

            if (currentLevel === 0 && hitTestRectangle(Alien, Portal) && hitTestRectangle(Alien1, Portal) && hitTestRectangle(Alien2, Portal) && hitTestRectangle(Alien3, Portal) && hitTestRectangle(Alien4, Portal)) {
                currentLevel = 1;
                app.stage.removeChild(gameScene)
                level2 = new Container();
                app.stage.addChild(level2)
                background = new Sprite(resources["background.jpg"].texture);
                level2.addChild(background);












































                var graphics = new PIXI.Graphics();
                graphics.lineStyle(2, 0x0000FF, 1);
                graphics.drawRect(0, 0, 160, window.innerHeight);
                app.stage.addChild(graphics)

                //Portal


                let basicStyle = new PIXI.TextStyle({
                    fill: "white"
                });
                const basicText = new PIXI.Text('Bonus Round', basicStyle);

                basicText.x = 900;
                basicText.y = 10;


                app.stage.addChild(basicText);

                Portal2 = new Sprite(resources["Portal.png"].texture);
                Portal2.position.set(890, 320);
                level2.addChild(Portal2);
                Portal2.scale.set(0.5);



                const basicText1 = new PIXI.Text('Controls:', basicStyle);
                app.stage.addChild(basicText1);
                basicText1.x = 20;
                basicText1.y = 700;

                const basicText2 = new PIXI.Text('Arrows:', basicStyle);
                app.stage.addChild(basicText2);
                basicText2.x = 20;
                basicText2.y = 750;

                const basicText3 = new PIXI.Text('Left, Right,', basicStyle);
                app.stage.addChild(basicText3);
                basicText3.x = 20;
                basicText3.y = 800;

                const basicText4 = new PIXI.Text('Up, Down', basicStyle);
                app.stage.addChild(basicText4);
                basicText4.x = 20;
                basicText4.y = 850;

                const basicText5 = new PIXI.Text('Health:', basicStyle);
                app.stage.addChild(basicText5);
                basicText5.x = 40;
                basicText5.y = 0;


                const basicText6 = new PIXI.Text('Fuel:', basicStyle);
                app.stage.addChild(basicText6);
                basicText6.x = 205;
                basicText6.y = 0;

                const basicText7 = new PIXI.Text("Try and Collect Your Reward without running out of Fuel. Then Go through the Final Portal ", basicStyle);
                app.stage.addChild(basicText7);
                basicText7.x = 480;
                basicText7.y = 40;




                //UFO2

                UFO = new Sprite(resources["UFO.png"].texture);
                UFO.x = 15;
                UFO.y = 50
                UFO.vx = 0;
                UFO.vy = 0;
                app.stage.addChild(UFO);
                UFO.scale.set(0.04);


                //coin
                coin13 = new Sprite(resources["coin.png"].texture);
                coin13.x = 700;
                coin13.y = 250;
                level2.addChild(coin13)
                coin13.scale.set(0.1);


                coin14 = new Sprite(resources["coin.png"].texture);
                coin14.x = 700;
                coin14.y = 550;
                level2.addChild(coin14)
                coin14.scale.set(0.1);




                coin15 = new Sprite(resources["coin.png"].texture);
                coin15.x = 1200;
                coin15.y = 550;
                level2.addChild(coin15)
                coin15.scale.set(0.1);

                coin16 = new Sprite(resources["coin.png"].texture);
                coin16.x = 1200;
                coin16.y = 250;
                level2.addChild(coin16)
                coin16.scale.set(0.1);

                coin17 = new Sprite(resources["coin.png"].texture);
                coin17.x = 1200;
                coin17.y = 100;
                level2.addChild(coin17)
                coin17.scale.set(0.1);



                coin18 = new Sprite(resources["coin.png"].texture);
                coin18.x = 1200;
                coin18.y = 700;
                level2.addChild(coin18)
                coin18.scale.set(0.1);



                coin19 = new Sprite(resources["coin.png"].texture);
                coin19.x = 700;
                coin19.y = 100;
                level2.addChild(coin19)
                coin19.scale.set(0.1);


                coin20 = new Sprite(resources["coin.png"].texture);
                coin20.x = 700;
                coin20.y = 700;
                level2.addChild(coin20)
                coin20.scale.set(0.1);


                coin21 = new Sprite(resources["coin.png"].texture);
                coin21.x = 950;
                coin21.y = 100;
                level2.addChild(coin21)
                coin21.scale.set(0.1);


                coin22 = new Sprite(resources["coin.png"].texture);
                coin22.x = 950;
                coin22.y = 700;
                level2.addChild(coin22)
                coin22.scale.set(0.1);

                coin23 = new Sprite(resources["coin.png"].texture);
                coin23.x = 500;
                coin23.y = 250;
                level2.addChild(coin23)
                coin23.scale.set(0.1);

                coin24 = new Sprite(resources["coin.png"].texture);
                coin24.x = 500;
                coin24.y = 550;
                level2.addChild(coin24)
                coin24.scale.set(0.1);


                coin25 = new Sprite(resources["coin.png"].texture);
                coin25.x = 1400;
                coin25.y = 250;
                level2.addChild(coin25)
                coin25.scale.set(0.1);


                coin26 = new Sprite(resources["coin.png"].texture);
                coin26.x = 1400;
                coin26.y = 550;
                level2.addChild(coin26)
                coin26.scale.set(0.1);


                coin = new Sprite(resources["coin.png"].texture);
                coin.x = 200;
                coin.y = 400;
                level2.addChild(coin)
                coin.scale.set(0.1);

                coin1 = new Sprite(resources["coin.png"].texture);
                coin1.x = 300;
                coin1.y = 400;
                level2.addChild(coin1)
                coin1.scale.set(0.1);

                coin2 = new Sprite(resources["coin.png"].texture);
                coin2.x = 400;
                coin2.y = 400;
                level2.addChild(coin2)
                coin2.scale.set(0.1);



                coin3 = new Sprite(resources["coin.png"].texture);
                coin3.x = 500;
                coin3.y = 400;
                level2.addChild(coin3)
                coin3.scale.set(0.1);



                coin4 = new Sprite(resources["coin.png"].texture);
                coin4.x = 600;
                coin4.y = 400;
                level2.addChild(coin4)
                coin4.scale.set(0.1);

                coin5 = new Sprite(resources["coin.png"].texture);
                coin5.x = 700;
                coin5.y = 400;
                level2.addChild(coin5)
                coin5.scale.set(0.1);

                coin6 = new Sprite(resources["coin.png"].texture);
                coin6.x = 1200;
                coin6.y = 400;
                level2.addChild(coin6)
                coin6.scale.set(0.1);


                coin7 = new Sprite(resources["coin.png"].texture);
                coin7.x = 1300;
                coin7.y = 400;
                level2.addChild(coin7)
                coin7.scale.set(0.1);


                coin8 = new Sprite(resources["coin.png"].texture);
                coin8.x = 1400;
                coin8.y = 400;
                level2.addChild(coin8)
                coin8.scale.set(0.1);

                coin9 = new Sprite(resources["coin.png"].texture);
                coin9.x = 1500;
                coin9.y = 400;
                level2.addChild(coin9)
                coin9.scale.set(0.1);

                coin10 = new Sprite(resources["coin.png"].texture);
                coin10.x = 1600;
                coin10.y = 400;
                level2.addChild(coin10)
                coin10.scale.set(0.1);

                coin11 = new Sprite(resources["coin.png"].texture);
                coin11.x = 1700;
                coin11.y = 400;
                level2.addChild(coin11)
                coin11.scale.set(0.1);

                coin12 = new Sprite(resources["coin.png"].texture);
                coin12.x = 1800;
                coin12.y = 400;
                level2.addChild(coin12)
                coin12.scale.set(0.1);




                //Make the Meteors
                let numberOfMeteors = 10,
                    spacing = 200,
                    xOffset = 200,
                    speed = 7,
                    ydirection = 1;
                xdirection = 1;



                //An array to store all the meteor 
                Meteors = [];

                //Make as many Meteors as there are `numberOfMeteors
                for (let i = 0; i < numberOfMeteors; i++) {

                    //Make a meteor

                    //let meteor = new Sprite(id["meteor.png"]);
                    let meteor;
                    meteorNumb = Math.floor(Math.random() * 3);
                    switch (meteorNumb) {
                        case 0:
                            meteor = new Sprite(resources["meteor2.png"].texture);
                            meteor.scale.set(0.5);
                            break;
                        case 1:
                            meteor = new Sprite(resources["meteor2.png"].texture);
                            meteor.scale.set(0.2);
                            break;
                        case 2:
                            meteor = new Sprite(resources["meteor2.png"].texture);
                            meteor.scale.set(0.3);
                            break;
                        default:
                            meteor = new Sprite(resources["meteor2.png"].texture);
                            break;
                    }


                    //Space each meteor horizontally according to the `spacing` value.
                    //`xOffset` determines the point from the left of the screen
                    //at which the first meteor should be added
                    let x = spacing * i + xOffset;

                    //Give the meteor a random y position
                    let y = randomInt(0, app.stage.height - meteor.height);

                    //Set the meteor's position
                    meteor.x = x;
                    meteor.y = y;

                    //Set the meteor's vertical velocity. `direction` will be either `1` or
                    //`-1`. `1` means the enemy will move down and `-1` means the meteor will
                    //move up. Multiplying `direction` by `speed` determines the meteor's
                    //vertical direction
                    meteor.vx = speed * xdirection * (Math.random() + 0.5);
                    meteor.vy = speed * ydirection * (Math.random() + 0.5);

                    //Reverse the direction for the next meteor
                    xdirection *= -1;
                    ydirection *= -1;

                    //Push the meteor into the `Meteors` array
                    Meteors.push(meteor);

                    //Add the meteor to the `gameScene`
                    level2.addChild(meteor);
                }













                //Create the health bar
                healthBar = new Container();
                healthBar.position.set(15, 30)
                level2.addChild(healthBar);





                healthBar.foo = 3456789
                    //Create the black background rectangle
                let innerBar = new Graphics();
                innerBar.beginFill(0x000000);
                innerBar.drawRect(0, 0, 128, 8);
                innerBar.endFill();
                healthBar.addChild(innerBar);

                //Create the front red rectangle
                let outerBar = new Graphics();
                outerBar.beginFill(0xFF3300);
                outerBar.drawRect(0, 0, 128, 8);
                outerBar.endFill();
                healthBar.addChild(outerBar);

                healthBar.outer = outerBar;


                //Create the fuel bar
                FuelBar = new Container();
                FuelBar.position.set(170, 30)
                level2.addChild(FuelBar);
                FuelBar.foo = 3456789
                    //Create the black background rectangle
                let innerBar1 = new Graphics();
                innerBar1.beginFill(0x000000);
                innerBar1.drawRect(0, 0, 128, 8);
                innerBar1.endFill();
                FuelBar.addChild(innerBar1);


                //Create the front red rectangle
                let outerBar1 = new Graphics();
                outerBar1.beginFill(0xFF3300);
                outerBar1.drawRect(0, 0, 128, 8);
                outerBar1.endFill();
                FuelBar.addChild(outerBar1);

                FuelBar.outer = outerBar1;
            }
            //Check for a collision between the explorer and the Alien
            if (coin23 !== undefined && hitTestRectangle(UFO, coin23)) {

                coin23.x = UFO.x + 22;
                coin23.y = UFO.y + 0.08;
            }


            //Check for a collision between the explorer and the Alien
            if (coin24 !== undefined && hitTestRectangle(UFO, coin24)) {

                //If the Alien is touching the explorer, center it over the explorer
                coin24.x = UFO.x + 22;
                coin24.y = UFO.y + 0.08;
            }





            //Check for a collision between the explorer and the Alien
            if (coin25 !== undefined && hitTestRectangle(UFO, coin25)) {

                //If the Alien is touching the explorer, center it over the explorer
                coin25.x = UFO.x + 22;
                coin25.y = UFO.y + 0.08;
            }




            //Check for a collision between the explorer and the Alien
            if (coin26 !== undefined && hitTestRectangle(UFO, coin26)) {

                //If the Alien is touching the explorer, center it over the explorer
                coin26.x = UFO.x + 22;
                coin26.y = UFO.y + 0.08;
            }



            //Check for a collision between the explorer and the Alien
            if (coin13 !== undefined && hitTestRectangle(UFO, coin13)) {

                //If the Alien is touching the explorer, center it over the explorer
                coin13.x = UFO.x + 22;
                coin13.y = UFO.y + 0.08;

            }


            //Check for a collision between the explorer and the Alien
            if (coin14 !== undefined && hitTestRectangle(UFO, coin14)) {

                //If the Alien is touching the explorer, center it over the explorer
                coin14.x = UFO.x + 22;
                coin14.y = UFO.y + 0.08;

            }

            //Check for a collision between the explorer and the Alien
            if (coin15 !== undefined && hitTestRectangle(UFO, coin15)) {

                //If the Alien is touching the explorer, center it over the explorer
                coin15.x = UFO.x + 22;
                coin15.y = UFO.y + 0.08;

            }



            //Check for a collision between the explorer and the Alien
            if (coin16 !== undefined && hitTestRectangle(UFO, coin16)) {

                //If the Alien is touching the explorer, center it over the explorer
                coin16.x = UFO.x + 22;
                coin16.y = UFO.y + 0.08;
            }


            //Check for a collision between the explorer and the Alien
            if (coin17 !== undefined && hitTestRectangle(UFO, coin17)) {

                //If the Alien is touching the explorer, center it over the explorer
                coin17.x = UFO.x + 22;
                coin17.y = UFO.y + 0.08;
            }



            //Check for a collision between the explorer and the Alien
            if (coin18 !== undefined && hitTestRectangle(UFO, coin18)) {

                //If the Alien is touching the explorer, center it over the explorer
                coin18.x = UFO.x + 22;
                coin18.y = UFO.y + 0.08;
            }


            //Check for a collision between the explorer and the Alien
            if (coin19 !== undefined && hitTestRectangle(UFO, coin19)) {

                //If the Alien is touching the explorer, center it over the explorer
                coin19.x = UFO.x + 22;
                coin19.y = UFO.y + 0.08;
            }


            //Check for a collision between the explorer and the Alien
            if (coin20 !== undefined && hitTestRectangle(UFO, coin20)) {

                //If the Alien is touching the explorer, center it over the explorer
                coin20.x = UFO.x + 22;
                coin20.y = UFO.y + 0.08;
            }


            //Check for a collision between the explorer and the Alien
            if (coin21 !== undefined && hitTestRectangle(UFO, coin21)) {

                //If the Alien is touching the explorer, center it over the explorer
                coin21.x = UFO.x + 22;
                coin21.y = UFO.y + 0.08;
            }


            //Check for a collision between the explorer and the Alien
            if (coin22 !== undefined && hitTestRectangle(UFO, coin22)) {

                //If the Alien is touching the explorer, center it over the explorer
                coin22.x = UFO.x + 22;
                coin22.y = UFO.y + 0.08;

            }


            //Check for a collision between the explorer and the Alien
            if (coin !== undefined && hitTestRectangle(UFO, coin)) {

                //If the Alien is touching the explorer, center it over the explorer
                coin.x = UFO.x + 22;
                coin.y = UFO.y + 0.08;
            }

            //Check for a collision between the explorer and the Alien
            if (coin1 !== undefined && hitTestRectangle(UFO, coin1)) {

                //If the Alien is touching the explorer, center it over the explorer
                coin1.x = UFO.x + 22;
                coin1.y = UFO.y + 0.08;
            }

            //Check for a collision between the explorer and the Alien
            if (coin2 !== undefined && hitTestRectangle(UFO, coin2)) {

                //If the Alien is touching the explorer, center it over the explorer
                coin2.x = UFO.x + 22;
                coin2.y = UFO.y + 0.08;
            }

            //Check for a collision between the explorer and the Alien
            if (coin3 !== undefined && hitTestRectangle(UFO, coin3)) {

                //If the Alien is touching the explorer, center it over the explorer
                coin3.x = UFO.x + 22;
                coin3.y = UFO.y + 0.08;
            }


            //Check for a collision between the explorer and the Alien
            if (coin4 !== undefined && hitTestRectangle(UFO, coin4)) {

                //If the Alien is touching the explorer, center it over the explorer
                coin4.x = UFO.x + 22;
                coin4.y = UFO.y + 0.08;
            }




            //Check for a collision between the explorer and the Alien
            if (coin5 !== undefined && hitTestRectangle(UFO, coin5)) {

                //If the Alien is touching the explorer, center it over the explorer
                coin5.x = UFO.x + 22;
                coin5.y = UFO.y + 0.08;
            }


            //Check for a collision between the explorer and the Alien
            if (coin6 !== undefined && hitTestRectangle(UFO, coin6)) {

                //If the Alien is touching the explorer, center it over the explorer
                coin6.x = UFO.x + 22;
                coin6.y = UFO.y + 0.08;
            }




            //Check for a collision between the explorer and the Alien
            if (coin7 !== undefined && hitTestRectangle(UFO, coin7)) {

                //If the Alien is touching the explorer, center it over the explorer
                coin7.x = UFO.x + 22;
                coin7.y = UFO.y + 0.08;
            }




            //Check for a collision between the explorer and the Alien
            if (coin8 !== undefined && hitTestRectangle(UFO, coin8)) {

                //If the Alien is touching the explorer, center it over the explorer
                coin8.x = UFO.x + 22;
                coin8.y = UFO.y + 0.08;
            }





            //Check for a collision between the explorer and the Alien
            if (coin9 !== undefined && hitTestRectangle(UFO, coin9)) {

                //If the Alien is touching the explorer, center it over the explorer
                coin9.x = UFO.x + 22;
                coin9.y = UFO.y + 0.08;
            }


            //Check for a collision between the explorer and the Alien
            if (coin10 !== undefined && hitTestRectangle(UFO, coin10)) {

                //If the Alien is touching the explorer, center it over the explorer
                coin10.x = UFO.x + 22;
                coin10.y = UFO.y + 0.08;
            }

            //Check for a collision between the explorer and the Alien
            if (coin11 !== undefined && hitTestRectangle(UFO, coin11)) {

                //If the Alien is touching the explorer, center it over the explorer
                coin11.x = UFO.x + 22;
                coin11.y = UFO.y + 0.08;
            }

            //Check for a collision between the explorer and the Alien
            if (coin12 !== undefined && hitTestRectangle(UFO, coin12)) {

                //If the Alien is touching the explorer, center it over the explorer
                coin12.x = UFO.x + 22;
                coin12.y = UFO.y + 0.08;
            }


            //Create the `gameOver` scene
            gameOverScene = new Container();
            app.stage.addChild(gameOverScene);

            //Does the explorer have enough health? If the width of the `innerBar`
            //is less than zero, end the game and display "You lost!"
            if (healthBar.outer.width < 0) {
                state = end;
                // message.text = "You Lost Try Again!";
                let ending = new Sprite(resources["end.png"].texture);
                gameOverScene.addChild(ending);
                ending.scale.set(0.44);
                setTimeout(function() {
                    location.reload()
                }, 2000);





            }
            if (fuel <= 0) {
                state = end;
                // message.text = "You Lost Try Again!";
                let ending = new Sprite(resources["end.png"].texture);
                gameOverScene.addChild(ending);
                ending.scale.set(0.44);
                setTimeout(function() {
                    location.reload()
                }, 2000);

            }


            //HERE
            if (currentLevel === 1 && hitTestRectangle(coin, Portal2) && hitTestRectangle(coin1, Portal2) && hitTestRectangle(coin2, Portal2) && hitTestRectangle(coin3, Portal2) && hitTestRectangle(coin4, Portal2) && hitTestRectangle(coin5, Portal2) && hitTestRectangle(coin6, Portal2) && hitTestRectangle(coin7, Portal2) && hitTestRectangle(coin8, Portal2) && hitTestRectangle(coin9, Portal2) && hitTestRectangle(coin10, Portal2) && hitTestRectangle(coin13, Portal2) && hitTestRectangle(coin14, Portal2) && hitTestRectangle(coin15, Portal2) && hitTestRectangle(coin16, Portal2) && hitTestRectangle(coin17, Portal2) && hitTestRectangle(coin18, Portal2) && hitTestRectangle(coin19, Portal2) && hitTestRectangle(coin20, Portal2) && hitTestRectangle(coin21, Portal2) && hitTestRectangle(coin22, Portal2) && hitTestRectangle(coin23, Portal2) && hitTestRectangle(coin24, Portal2) && hitTestRectangle(coin25, Portal2) && hitTestRectangle(coin26, Portal2)) {
                won  =  new  Sprite(resources["win.png"].texture);
                won.zOrder = 1;
                gameOverScene.addChild(won);
                won.scale.set(0.95);
                state = end;
                setTimeout(function() {
                    location.reload()
                }, 5000);

            }
        }

        function end() {
            gameScene.visible = false;
            if (level2 !== undefined) {
                level2.visible = false;
            }
            gameOverScene.visible = true;
            state = end;
        }


























































        /* Helper functions */

        function contain(sprite, container) {

            let collision = undefined;

            //Left
            if (sprite.x < container.x) {
                sprite.x = container.x;
                collision = "left";
            }

            //Top
            if (sprite.y < container.y) {
                sprite.y = container.y;
                collision = "top";
            }

            //Right
            if (sprite.x + sprite.width > container.width) {
                sprite.x = container.width - sprite.width;
                collision = "right";
            }

            //Bottom
            if (sprite.y + sprite.height > container.height) {
                sprite.y = container.height - sprite.height;
                collision = "bottom";
            }

            //Return the `collision` value
            return collision;
        }

        //The `hitTestRectangle` function
        function hitTestRectangle(r1, r2) {

            //Define the variables we'll need to calculate
            let hit, combinedHalfWidths, combinedHalfHeights, vx, vy;

            //hit will determine whether there's a collision
            hit = false;

            //Find the center points of each sprite
            r1.centerX = r1.x + r1.width / 2;
            r1.centerY = r1.y + r1.height / 2;
            r2.centerX = r2.x + r2.width / 2;
            r2.centerY = r2.y + r2.height / 2;

            //Find the half-widths and half-heights of each sprite
            r1.halfWidth = r1.width / 2;
            r1.halfHeight = r1.height / 2;
            r2.halfWidth = r2.width / 2;
            r2.halfHeight = r2.height / 2;

            //Calculate the distance vector between the sprites
            vx = r1.centerX - r2.centerX;
            vy = r1.centerY - r2.centerY;

            //Figure out the combined half-widths and half-heights
            combinedHalfWidths = r1.halfWidth + r2.halfWidth;
            combinedHalfHeights = r1.halfHeight + r2.halfHeight;

            //Check for a collision on the x axis
            if (Math.abs(vx) < combinedHalfWidths) {

                //A collision might be occuring. Check for a collision on the y axis
                if (Math.abs(vy) < combinedHalfHeights) {

                    //There's definitely a collision happening
                    hit = true;
                } else {

                    //There's no collision on the y axis
                    hit = false;
                }
            } else {

                //There's no collision on the x axis
                hit = false;
            }

            //`hit` will be either `true` or `false`
            return hit;
        };


        //The `randomInt` helper function
        function randomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        //The `keyboard` helper function
        function keyboard(keyCode) {
            var key = {};
            key.code = keyCode;
            key.isDown = false;
            key.isUp = true;
            key.press = undefined;
            key.release = undefined;
            //The `downHandler`
            key.downHandler = function(event) {
                if (event.keyCode === key.code) {
                    if (key.isUp && key.press) key.press();
                    key.isDown = true;
                    key.isUp = false;
                }
                event.preventDefault();
            };

            //The `upHandler`
            key.upHandler = function(event) {
                if (event.keyCode === key.code) {
                    if (key.isDown && key.release) key.release();
                    key.isDown = false;
                    key.isUp = true;
                }
                event.preventDefault();
            };

            //Attach event listeners
            window.addEventListener(
                "keydown", key.downHandler.bind(key), false
            );
            window.addEventListener(
                "keyup", key.upHandler.bind(key), false
            );
            return key;
        }
        state = end;
    </script>
</body>